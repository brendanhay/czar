package protocol;

message Threshold {
  optional double lower = 1;
  optional double upper = 2;
}

message Metric {
  required int64 time = 1;
  optional string type = 2;
  required string key = 3;
  required double value = 4;
  optional Threshold warning = 5;
  optional Threshold critical = 6;
}

message Attribute {
  required string key = 1;
  required string value = 2;
}

message Tag {
  required string name = 1;
}

message Event {
  required int64 time = 1;
  required string host = 2;
  required string key = 3;
  optional string description = 4;
  repeated Tag tags = 5;
  repeated Metric metrics = 6;
  repeated Attribute attributes = 7;
}

message Subscription {
  required string identity = 1;
  optional string description = 2;
  repeated Tag tags = 5;
}

message Heartbeat {
  enum Mode {
    SYN = 1;
    ACK = 2;
    FIN = 3;
  }

  required Mode mode = 1;
}
